// Generated by CoffeeScript 1.7.1
if("undefined"==typeof Color)var Color={};"undefined"==typeof Color.Space&&(Color.Space={}),function(){"use strict";var useEval=!1,functions={},shortcuts={"HEX24>HSL":"HEX24>RGB>HSL","HEX32>HSLA":"HEX32>RGBA>HSLA","HEX24>CMYK":"HEX24>RGB>CMY>CMYK","RGB>CMYK":"RGB>CMY>CMYK"},root=Color.Space=function(color,route){shortcuts[route]&&(route=shortcuts[route]);var r=route.split(">");if("object"==typeof color&&color[0]>=0){for(var type=r[0],tmp={},i=0;i<type.length;i++){var str=type.substr(i,1);tmp[str]=color[i]}color=tmp}if(functions[route])return functions[route](color);for(var f="color",pos=1,key=r[0];pos<r.length;pos++)pos>1&&(key=key.substr(key.indexOf("_")+1)),key+=(0===pos?"":"_")+r[pos],color=root[key](color),useEval&&(f="Color.Space."+key+"("+f+")");return useEval&&(functions[route]=eval("(function(color) { return "+f+" })")),color};root.RGB_W3=function(t){return"rgb("+(t.R>>0)+","+(t.G>>0)+","+(t.B>>0)+")"},root.RGBA_W3=function(t){var e="number"==typeof t.A?t.A/255:1;return"rgba("+(t.R>>0)+","+(t.G>>0)+","+(t.B>>0)+","+e+")"},root.W3_RGB=function(t){return t=t.substr(4,t.length-5).split(","),{R:parseInt(t[0],10),G:parseInt(t[1],10),B:parseInt(t[2],10)}},root.W3_RGBA=function(t){return t=t.substr(5,t.length-6).split(","),{R:parseInt(t[0],10),G:parseInt(t[1],10),B:parseInt(t[2],10),A:255*parseFloat(t[3])}},root.HSL_W3=function(t){return"hsl("+(t.H+.5>>0)+","+(t.S+.5>>0)+"%,"+(t.L+.5>>0)+"%)"},root.HSLA_W3=function(t){var e="number"==typeof t.A?t.A/255:1;return"hsla("+(t.H+.5>>0)+","+(t.S+.5>>0)+"%,"+(t.L+.5>>0)+"%,"+e+")"},root.W3_HSL=function(t){var e=t.indexOf("(")+1,n=t.indexOf(")");return t=t.substr(e,n-e).split(","),{H:parseInt(t[0],10),S:parseInt(t[1],10),L:parseInt(t[2],10)}},root.W3_HSLA=function(t){var e=t.indexOf("(")+1,n=t.indexOf(")");return t=t.substr(e,n-e).split(","),{H:parseInt(t[0],10),S:parseInt(t[1],10),L:parseInt(t[2],10),A:255*parseFloat(t[3],10)}},root.W3_HEX=root.W3_HEX24=function(t){return"#"===t.substr(0,1)&&(t=t.substr(1)),3===t.length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),parseInt("0x"+t,16)},root.W3_HEX32=function(t){return"#"===t.substr(0,1)&&(t=t.substr(1)),6===t.length?parseInt("0xFF"+t,10):parseInt("0x"+t,16)},root.HEX_W3=root.HEX24_W3=function(t,e){e||(e=6),t||(t=0);var n,r=t.toString(16);for(n=r.length;e>n;)r="0"+r,n++;for(n=r.length;n>e;)r=r.substr(1),n--;return"#"+r},root.HEX32_W3=function(t){return root.HEX_W3(t,8)},root.HEX_RGB=root.HEX24_RGB=function(t){return{R:t>>16,G:t>>8&255,B:255&t}},root.HEX32_RGBA=function(t){return{R:t>>>16&255,G:t>>>8&255,B:255&t,A:t>>>24}},root.RGBA_HEX32=function(t){return(t.A<<24|t.R<<16|t.G<<8|t.B)>>>0},root.RGB_HEX24=root.RGB_HEX=function(t){return t.R<0&&(t.R=0),t.G<0&&(t.G=0),t.B<0&&(t.B=0),t.R>255&&(t.R=255),t.G>255&&(t.G=255),t.B>255&&(t.B=255),t.R<<16|t.G<<8|t.B},root.RGB_CMY=function(t){return{C:1-t.R/255,M:1-t.G/255,Y:1-t.B/255}},root.RGBA_HSLA=root.RGB_HSL=function(t){var e,n,r=t.R/255,o=t.G/255,i=t.B/255,s=Math.min(r,o,i),a=Math.max(r,o,i),l=a-s,u=(a+s)/2;if(0===l)e=0,n=0;else{n=.5>u?l/(a+s):l/(2-a-s);var c=((a-r)/6+l/2)/l,d=((a-o)/6+l/2)/l,h=((a-i)/6+l/2)/l;r===a?e=h-d:o===a?e=1/3+c-h:i===a&&(e=2/3+d-c),0>e&&(e+=1),e>1&&(e-=1)}return{H:360*e,S:100*n,L:100*u,A:t.A}},root.RGBA_HSVA=root.RGB_HSV=function(t){var e,n,r=t.R/255,o=t.G/255,i=t.B/255,s=Math.min(r,o,i),a=Math.max(r,o,i),l=a-s,u=a;if(0===l)e=0,n=0;else{n=l/a;var c=((a-r)/6+l/2)/l,d=((a-o)/6+l/2)/l,h=((a-i)/6+l/2)/l;r===a?e=h-d:o===a?e=1/3+c-h:i===a&&(e=2/3+d-c),0>e&&(e+=1),e>1&&(e-=1)}return{H:360*e,S:100*n,V:100*u,A:t.A}},root.CMY_RGB=function(t){return{R:Math.max(0,255*(1-t.C)),G:Math.max(0,255*(1-t.M)),B:Math.max(0,255*(1-t.Y))}},root.CMY_CMYK=function(t){var e=t.C,n=t.M,r=t.Y,o=Math.min(r,Math.min(n,Math.min(e,1)));return e=Math.round((e-o)/(1-o)*100),n=Math.round((n-o)/(1-o)*100),r=Math.round((r-o)/(1-o)*100),o=Math.round(100*o),{C:e,M:n,Y:r,K:o}},root.CMYK_CMY=function(t){return{C:t.C*(1-t.K)+t.K,M:t.M*(1-t.K)+t.K,Y:t.Y*(1-t.K)+t.K}},root.HSLA_RGBA=root.HSL_RGB=function(t){var e,n,r,o,i,s,a=t.H/360,l=t.S/100,u=t.L/100;return 0===l?e=n=r=u:(i=.5>u?u*(1+l):u+l-l*u,o=2*u-i,s=a+1/3,0>s&&(s+=1),s>1&&(s-=1),e=1>6*s?o+6*(i-o)*s:1>2*s?i:2>3*s?o+(i-o)*(2/3-s)*6:o,s=a,0>s&&(s+=1),s>1&&(s-=1),n=1>6*s?o+6*(i-o)*s:1>2*s?i:2>3*s?o+(i-o)*(2/3-s)*6:o,s=a-1/3,0>s&&(s+=1),s>1&&(s-=1),r=1>6*s?o+6*(i-o)*s:1>2*s?i:2>3*s?o+(i-o)*(2/3-s)*6:o),{R:255*e,G:255*n,B:255*r,A:t.A}},root.HSVA_RGBA=root.HSV_RGB=function(t){var e,n,r,o,i,s,a=t.H/360,l=t.S/100,u=t.V/100;if(0===l)e=n=r=Math.round(255*u);else switch(a>=1&&(a=0),a=6*a,o=a-Math.floor(a),i=Math.round(255*u*(1-l)),r=Math.round(255*u*(1-l*o)),s=Math.round(255*u*(1-l*(1-o))),u=Math.round(255*u),Math.floor(a)){case 0:e=u,n=s,r=i;break;case 1:e=r,n=u,r=i;break;case 2:e=i,n=u,r=s;break;case 3:e=i,n=r,r=u;break;case 4:e=s,n=i,r=u;break;case 5:e=u,n=i,r=r}return{R:e,G:n,B:r,A:t.A}}}(),function(){var t,e,n,r,o,i,s,a,l,u,c,d,h=[].slice;s=function(t,e,n){return n=0>n?n+1:n>1?n-1:n,1>6*n?t+(e-t)*n*6:1>2*n?e:2>3*n?t+(e-t)*(.66666-n)*6:t},i=function(t,e,n){var r,o;return o=.5>=n?n*(e+1):n+e-n*e,r=2*n-o,{r:s(r,o,t+.33333),g:s(r,o,t),b:s(r,o,t-.33333)}},c=function(t,e,n){var r,o,i,s,a,l,u;return s=Math.max(t,e,n),a=Math.min(t,e,n),r=s-a,u=s+a,o=a===s?0:t===s?(60*(e-n)/r+360)%360:e===s?60*(n-t)/r+120:60*(t-e)/r+240,i=u/2,l=0===i?0:1===i?1:.5>=i?r/u:r/(2-u),{h:o,s:l,l:i}},o=function(t,e,n,o){return null!=o?"hsla("+r(Math.round(180*t/Math.PI),360)+","+Math.round(100*e)+"%,"+Math.round(100*n)+"%,"+o+")":"hsl("+r(Math.round(180*t/Math.PI),360)+","+Math.round(100*e)+"%,"+Math.round(100*n)+"%)"},n=function(t){var e,n,r,o,i,s;return s=document.createElement("span"),document.body.appendChild(s),s.style.backgroundColor=t,i=getComputedStyle(s).backgroundColor,document.body.removeChild(s),r=/^rgb\((\d+), (\d+), (\d+)\)$/.exec(i),r||(r=/^rgba\((\d+), (\d+), (\d+), ([\d.]+)\)$/.exec(i)),o=parseInt(r[1]),n=parseInt(r[2]),e=parseInt(r[3]),r[4]?{r:o/255,g:n/255,b:e/255,a:parseFloat(r[4])}:{r:o/255,g:n/255,b:e/255}},a=function(t){var e,n;return n=document.createElement("span"),document.body.appendChild(n),n.style.backgroundColor=t,e=n.style.backgroundColor.length>0,n.remove(),e},d=function(t,e){var n,r;for(n in e)r=e[n],t.style[n]=r;return t},r=function(t,e){return t%=e,0>t&&(t+=e),t},l=function(t,e,n){return e+(n-e)*Math.min(1,Math.max(0,t))},t=function(){function t(t,e,n){var r,o,s,a,l,u,c,d,h,p,v,m,f,g,b,y,w,x,M,E,C;for(this.radius=t,this.width=e,this.lightness=n,g=this.radius,M=this.width,o=this.canvas=document.createElement("canvas"),o.width=o.height=2*g,s=o.getContext("2d"),v=s.createImageData(o.width,o.height),l=v.data,C=p=0,b=o.height;b>=0?b>p:p>b;C=b>=0?++p:--p)for(E=m=0,y=o.width;y>=0?y>m:m>y;E=y>=0?++m:--m)c=C-g,u=E-g,a=Math.sqrt(c*c+u*u),a>g+1.5||(a-=10,x=Math.max(0,Math.min(1,a/(g-M/2-10))),h=Math.atan2(c,u)/(2*Math.PI),w=i(h,x,this.lightness),f=w.r,d=w.g,r=w.b,l[4*(C*o.width+E)+0]=255*f,l[4*(C*o.width+E)+1]=255*d,l[4*(C*o.width+E)+2]=255*r,l[4*(C*o.width+E)+3]=255);s.putImageData(v,0,0)}return t.prototype.drawHSLCircle=function(t,e){var n,r,o,i;return t.width=t.height=2*this.radius,n=t.getContext("2d"),i=this.width,o=this.radius,r=l(e,i,o),n.save(),n.fillStyle="rgba(0,0,0,0.3)",n.beginPath(),n.arc(o,o,o,0,2*Math.PI),n.fill(),n.fillStyle="black",n.beginPath(),n.arc(o,o,r,0,2*Math.PI),n.arc(o,o,r-i,0,2*Math.PI,!0),n.fill(),n.globalCompositeOperation="source-in",n.drawImage(this.canvas,0,0),n.restore()},t}(),u=function(t){return"string"==typeof t&&(t=n(t)),null!=t.r&&null!=t.g&&null!=t.b?(t=c(t.r,t.g,t.b),t.h=t.h*Math.PI/180):null!=t.h&&null!=t.s&&null!=t.l&&(t.h=t.h*Math.PI/180),t},e=function(){function e(t){this.color=u(t),this.refColor=this.color,this.el=f(),this.circleContainer=this.el.appendChild(a.call(this)),this.lSlider=this.el.appendChild(m.call(this)),this.colorPreview=this.el.appendChild(p.call(this)),s.call(this),this.setLightness(this.color.l)}var s,a,p,v,m,f,g,b;return g=80,b=25,e.prototype.setHue=function(t){var e,n,r;return this.color.h=t,r=l(this.color.s,b,g)-b/2,n=g-b/2,d(this.hueKnob,{left:Math.round(n+Math.cos(t)*r+6-1)+"px",top:Math.round(n+Math.sin(t)*r+6-1)+"px"}),this.colorPreview.style.backgroundColor=this.lKnob.style.backgroundColor=this.hueKnob.style.backgroundColor=o(this.color.h,this.color.s,this.color.l),e=o(this.color.h,this.color.s,.5),this.lSlider.style.backgroundImage="-webkit-linear-gradient(bottom, black, "+e+" 50%, white)",this.lSlider.style.backgroundImage="-moz-linear-gradient(bottom, black, "+e+" 50%, white)",this.emit("changed")},e.prototype.setSaturation=function(t){return this.color.s=t,this.circle.drawHSLCircle(this.circleCanvas,t),this.setHue(this.color.h)},e.prototype.setLightness=function(e){return this.color.l=e,this.circle=new t(g,b,e),this.lKnob.style.top=(1-e)*this.lSlider._height-11+"px",this.setSaturation(this.color.s)},e.prototype.setHSL=function(t,e,n){return this.color.h=r(t,360)*Math.PI/180,this.color.s=Math.max(0,Math.min(1,e)),n=Math.max(0,Math.min(1,n)),this.setLightness(n)},e.prototype.getHSL=function(){return{h:r(180*this.color.h/Math.PI,360),s:this.color.s,l:this.color.l}},e.prototype.setRGB=function(t,e,n){var r,o,i,s;return i=c(t,e,n),r=i.h,s=i.s,o=i.l,this.setHSL(r,s,o)},e.prototype.getRGB=function(){return i(this.color.h/(2*Math.PI),this.color.s,this.color.l)},e.prototype.getCSS=function(){return o(this.color.h,this.color.s,this.color.l)},e.prototype.setCSS=function(t){var e,r,o,i;return i=n(t),o=i.r,r=i.g,e=i.b,this.setRGB(o,r,e)},e.prototype.on=function(t,e){var n;return null==this._listeners&&(this._listeners={}),(null!=(n=this._listeners)[t]?n[t]:n[t]=[]).push(e)},e.prototype.emit=function(){var t,e,n,r,o,i,s,a;if(e=arguments[0],t=2<=arguments.length?h.call(arguments,1):[],this._listeners){for(s=null!=(i=this._listeners[e])?i:[],a=[],n=0,o=s.length;o>n;n++)r=s[n],a.push(r.call.apply(r,[this].concat(h.call(t))));return a}},e.prototype.removeListener=function(t,e){var n;return this._listeners[t]?this._listeners[t]=function(){var r,o,i,s;for(i=this._listeners[t],s=[],r=0,o=i.length;o>r;r++)n=i[r],n!==e&&s.push(n);return s}.call(this):void 0},s=function(){var t,e;return this.lKnob.onmousedown=function(t){return function(e){var n,r;return document.documentElement.style.cursor="pointer",window.addEventListener("mousemove",n=function(e){var n,r;return n=t.lSlider.getBoundingClientRect(),r=e.clientY-n.top,t.setLightness(Math.max(0,Math.min(1,1-r/t.lSlider._height)))}),window.addEventListener("mouseup",r=function(t){return window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",r),window.removeEventListener("blur",r),document.documentElement.style.cursor=""}),window.addEventListener("blur",r),e.preventDefault(),e.stopPropagation()}}(this),this.lKnob.ontouchstart=function(t){return function(e){var n,r;return document.documentElement.style.cursor="pointer",window.addEventListener("touchmove",n=function(e){var n,r;return n=t.lSlider.getBoundingClientRect(),r=e.clientY-n.top,t.setLightness(Math.max(0,Math.min(1,1-r/t.lSlider._height)))}),window.addEventListener("touchend",r=function(t){return window.removeEventListener("touchmove",n),window.removeEventListener("touchend",r),window.removeEventListener("blur",r),document.documentElement.style.cursor=""}),window.addEventListener("blur",r),e.preventDefault(),e.stopPropagation()}}(this),t=this.circleContainer,e=function(e){return function(n){var r,o,i,s,a,u,c;return u=n.layerX,c=n.layerY,o=u-g,i=c-g,r=Math.sqrt(o*o+i*i),a=Math.atan2(i,o),s=l(e.color.s,b,g),r>s-b&&s>r?-Math.PI/8<a&&a<Math.PI/8||a>=7*Math.PI/8||a<=-7*Math.PI/8?t.style.cursor="ew-resize":Math.PI/8<=a&&a<3*Math.PI/8||-7*Math.PI/8<a&&a<=-5*Math.PI/8?t.style.cursor="nwse-resize":3*Math.PI/8<=a&&a<5*Math.PI/8||-5*Math.PI/8<a&&a<=-3*Math.PI/8?t.style.cursor="ns-resize":5*Math.PI/8<=a&&a<7*Math.PI/8||-3*Math.PI/8<a&&a<=-Math.PI/8?t.style.cursor="nesw-resize":void 0:t.style.cursor=""}}(this),t.addEventListener("mouseover",function(n){var r,o;return e(n),t.addEventListener("mousemove",r=function(t){return e(t)}),t.addEventListener("mouseout",o=function(e){return t.style.cursor="",t.removeEventListener("mousemove",r),t.removeEventListener("mouseout",o),window.removeEventListener("blur",o)}),window.addEventListener("blur",o)}),t.addEventListener("mousedown",function(e){return function(n){var r,o,i,s,a,u,c,d,h;return n.preventDefault(),d=n.layerX,h=n.layerY,o=d-g,i=h-g,r=Math.sqrt(o*o+i*i),u=Math.atan2(i,o),a=l(e.color.s,b,g),r>a-b&&a>r?(document.documentElement.style.cursor=t.style.cursor,window.addEventListener("mousemove",s=function(t){var n,s,l;return a=e.circleCanvas.getBoundingClientRect(),n=a.left+a.width/2,s=a.top+a.height/2,o=t.clientX-n,i=t.clientY-s,r=Math.sqrt(o*o+i*i),r-=10,l=Math.max(0,Math.min(1,r/(g-b/2-10))),e.setSaturation(l)}),window.addEventListener("mouseup",c=function(t){return window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",c),window.removeEventListener("blur",c),document.documentElement.style.cursor=""}),window.addEventListener("blur",c)):void 0}}(this)),t.addEventListener("touchstart",function(e){return function(n){var r,o,i,s,a,u,c,d,h;return n.preventDefault(),d=n.layerX,h=n.layerY,o=d-g,i=h-g,r=Math.sqrt(o*o+i*i),u=Math.atan2(i,o),a=l(e.color.s,b,g),r>a-b&&a>r?(document.documentElement.style.cursor=t.style.cursor,window.addEventListener("touchmove",s=function(t){var n,s,l;return a=e.circleCanvas.getBoundingClientRect(),n=a.left+a.width/2,s=a.top+a.height/2,o=t.clientX-n,i=t.clientY-s,r=Math.sqrt(o*o+i*i),r-=10,l=Math.max(0,Math.min(1,r/(g-b/2-10))),e.setSaturation(l)}),window.addEventListener("touchend",c=function(t){return window.removeEventListener("touchmove",s),window.removeEventListener("touchend",c),window.removeEventListener("blur",c),document.documentElement.style.cursor=""}),window.addEventListener("blur",c)):void 0}}(this)),this.hueKnob.onmousedown=function(t){return function(e){var n,r;return document.documentElement.style.cursor="pointer",window.addEventListener("mousemove",n=function(e){var n,r,o;return o=t.circleCanvas.getBoundingClientRect(),n=o.left+o.width/2,r=o.top+o.height/2,t.setHue(Math.atan2(e.clientY-r,e.clientX-n))}),window.addEventListener("mouseup",r=function(t){return window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",r),window.removeEventListener("blur",r),document.documentElement.style.cursor=""}),window.addEventListener("blur",r),e.preventDefault(),e.stopPropagation()}}(this)},f=function(){var t;return t=document.createElement("div"),t.className="picker",d(t,{display:"inline-block",background:"hsl(0, 0%, 97%)",padding:"6px",borderRadius:"6px",boxShadow:"1px 1px 5px hsla(0, 0%, 39%, 0.2), hsla(0, 0%, 100%, 0.9) 0px 0px 1em 0.3em inset",border:"1px solid hsla(0, 0%, 59%, 0.2)",position:"absolute",backgroundImage:"-webkit-linear-gradient(left top, hsla(0, 0%, 0%, 0.05) 25%, transparent 25%, transparent 50%, hsla(0, 0%, 0%, 0.05) 50%, hsla(0, 0%, 0%, 0.05) 75%, transparent 75%, transparent)",backgroundSize:"40px 40px"}),d(t,{backgroundImage:"-moz-linear-gradient(left top, hsla(0, 0%, 0%, 0.05) 25%, transparent 25%, transparent 50%, hsla(0, 0%, 0%, 0.05) 50%, hsla(0, 0%, 0%, 0.05) 75%, transparent 75%, transparent)",zIndex:"1000"}),t},a=function(){var t,e;return t=document.createElement("div"),d(t,{display:"inline-block",width:2*g+"px",height:2*g+"px",borderRadius:g+"px",boxShadow:"0px 0px 7px rgba(0,0,0,0.3)"}),t.appendChild(this.circleCanvas=document.createElement("canvas")),this.hueKnob=e=v(27),t.appendChild(e),t},m=function(){var t,e;return e=document.createElement("div"),d(e,{display:"inline-block",width:"20px",height:2*g-22+"px",marginLeft:"6px",borderRadius:"10px",boxShadow:"hsla(0, 100%, 100%, 0.1) 0 1px 2px 1px inset, hsla(0, 100%, 100%, 0.2) 0 1px inset, hsla(0, 0%, 0%, 0.4) 0 -1px 1px inset, hsla(0, 0%, 0%, 0.4) 0 1px 1px",position:"relative",top:"-11px"}),e._height=2*g-22,this.lKnob=t=v(22),d(t,{left:"-1px"}),e.appendChild(t),e},p=function(){var t,e,n;return t=document.createElement("div"),e=o(this.refColor.h,this.refColor.s,this.refColor.l),n=o(this.refColor.h,this.refColor.s,this.refColor.l,0),d(t,{boxShadow:"hsla(0, 0%, 0%, 0.5) 0 1px 5px, hsla(0, 100%, 100%, 0.4) 0 1px 1px inset, hsla(0, 0%, 0%, 0.3) 0 -1px 1px inset",height:"25px",marginTop:"6px",borderRadius:"3px",backgroundImage:"-webkit-linear-gradient(-20deg, "+n+", "+n+" 69%, "+e+" 70%, "+e+")"}),d(t,{backgroundImage:"-moz-linear-gradient(-20deg, "+n+", "+n+" 69%, "+e+" 70%, "+e+")"}),t},v=function(t){var e;return e=document.createElement("div"),e.className="knob",d(e,{position:"absolute",width:t+"px",height:t+"px",backgroundColor:"red",borderRadius:Math.floor(t/2)+"px",cursor:"pointer",backgroundImage:"-webkit-gradient(radial, 50% 0%, 0, 50% 0%, 15, color-stop(0%, rgba(255, 255, 255, 0.8)), color-stop(100%, rgba(255, 255, 255, 0.2)))",boxShadow:"white 0px 1px 1px inset, rgba(0, 0, 0, 0.4) 0px -1px 1px inset, rgba(0, 0, 0, 0.4) 0px 1px 4px 0px, rgba(0, 0, 0, 0.6) 0 0 2px"}),d(e,{backgroundImage:"radial-gradient(circle at center top, rgba(255,255,255,0.8), rgba(255, 255, 255, 0.2) 15px"}),e},e.prototype.presentModal=function(t,e){var n;return d(this.el,{left:t+"px",top:e-10+"px",opacity:"0",webkitTransition:"0.15s",MozTransition:"0.15s"}),n=document.createElement("div"),n.style.position="fixed",n.style.top=n.style.left=n.style.bottom=n.style.right="0",n.style.zIndex="999",n.onclick=function(t){return function(){var r;return document.body.removeChild(n),t.el.style.top=e+10+"px",t.el.style.opacity=0,r=function(){return document.body.removeChild(t.el),t.el.removeEventListener("webkitTransitionEnd",r),t.el.removeEventListener("transitionend",r)},t.el.addEventListener("webkitTransitionEnd",r),t.el.addEventListener("transitionend",r),t.emit("closed")}}(this),document.body.appendChild(n),document.body.appendChild(this.el),this.el.offsetHeight,this.el.style.opacity="1",this.el.style.top=e+"px",this},e.prototype.presentModalBeneath=function(t){var e,n,r;return e=t.getBoundingClientRect(),n=e.left+window.scrollX,r=e.bottom+window.scrollY+4,this.presentModal(n,r)},e}(),window.thistle={Picker:e,isValidCSSColor:a}}.call(this),Inlet=function(){function t(t,n){function r(t){var e=String(p.checked),n=v.getCursor(!0),r=c(n,"boolean");if(r){var o={line:n.line,ch:r.start},i={line:n.line,ch:r.end};v.replaceRange(e,o,i)}}function o(t){var e=String(d.value),n=v.getCursor(!0),r=c(n,"number");if(r){var o={line:n.line,ch:r.start},i={line:n.line,ch:r.end};v.dragging=!0,v.replaceRange(e,o,i)}}function i(t){d.value=0;var e=v.getCursor(!0),n=c(e,"number");if(n){var r=parseFloat(n.string),o=u(r);d.setAttribute("value",r),d.setAttribute("step",o.step),d.setAttribute("min",o.min),d.setAttribute("max",o.max),d.value=r,v.dragging=!1}}function s(t){t.target!==I&&t.target!==S&&t.target!==d&&t.target!==L&&t.target!==p&&(S.style.visibility="hidden",L.style.visibility="hidden")}function a(){if(1==arguments.length?event=arguments[0]:event=arguments[1],event.keyCode==B||event.keyCode==_){if("visible"===S.style.visibility)return d.stepDown(1),o(),!0;event.altKey&&l()}else if(event.keyCode==A||event.keyCode==H){if("visible"===S.style.visibility)return d.stepUp(1),o(),!0;event.altKey&&l()}else S.style.visibility="hidden"}function l(t){if(!v.somethingSelected()){I=t.target;var n=v.getCursor(!0);v.getTokenAt(n);cursorOffset=v.cursorCoords(!0,"page");var o=v.cursorCoords(!0,E).left,i=c(n,"number"),s=c(n,"hsl"),a=c(n,"hex"),l=c(n,"rgb"),m=c(n,"boolean"),M=cursorOffset.top-f;cursorOffset.top<b&&(M=cursorOffset.top+g);var C=o-y;if(S.style.visibility="hidden",L.style.visibility="hidden",a){var k=a.string;h=new thistle.Picker(k),h.setCSS(k),h.presentModal(C,M),h.on("changed",function(){picked=h.getCSS(),picked=Color.Space(picked,"W3>HSL>RGB>HEX24>W3"),G(picked,"hex")})}else if(s){var k=s.string;h=new thistle.Picker(k),h.setCSS(k),h.presentModal(C,M),h.on("changed",function(){picked=h.getCSS(),G(picked,"hsl")})}else if(l){var k=l.string;h=new thistle.Picker(k),h.setCSS(k),h.presentModal(C,M),h.on("changed",function(){picked=h.getCSS(),picked=Color.Space(picked,"W3>HSL>RGB>W3"),G(picked,"rgb")})}else if(i){d.value=0;var R=parseFloat(i.string),B=u(R);d.setAttribute("value",R),d.setAttribute("step",B.step),d.setAttribute("min",B.min),d.setAttribute("max",B.max),d.value=R;var H=cursorOffset.top-w,A=window.getComputedStyle(S),_=e(A.width),P=o-_/2+x;S.style.top=H-10+"px",S.style.left=P+"px",S.style.visibility="visible"}else if(m){var X=cursorOffset.top-w,Y=window.getComputedStyle(L),K=e(Y.width),O=o-K/2+x,R=JSON.parse(m.string);R?(L.removeChild(p),p=document.createElement("input"),p.className="checkbox",p.setAttribute("type","checkbox"),p.setAttribute("checked","checked"),p.addEventListener("change",r),L.appendChild(p)):(L.removeChild(p),p=document.createElement("input"),p.className="checkbox",p.setAttribute("type","checkbox"),p.addEventListener("change",r),L.appendChild(p)),L.style.top=X-3+"px",L.style.left=O+"px",L.style.visibility="visible"}}}function u(t){var e,n;return e=0===t?[-100,100]:[3*-t,5*t],e[0]<e[1]?(min=e[0],max=e[1]):(min=e[1],max=e[0]),n=max-min>20?1:(max-min)/200,{min:min,max:max,step:n}}function c(t,e){if(e){var n;switch(e.toLowerCase()){case"boolean":n=/true|false/g;break;case"hsl":n=/hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)/g;break;case"rgb":n=/rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)/g;break;case"hex":n=/#[a-fA-F0-9]{3,6}/g;break;case"number":n=/[-]?\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g;break;default:throw new Error("invalid match selection")}for(var r=v.getLine(t.line),o=n.exec(r);o;){var i=o[0],s=i.length,a=o.index,l=o.index+s;if(t.ch>=a&&t.ch<=l)return o=null,{start:a,end:l,string:i};o=n.exec(r)}}}var d,h,p,v=t;n||(n={}),n.picker||(n.picker={}),n.slider||(n.slider={}),n.clicker||(n.clicker={});var m=n.container||document.body,f=n.picker.topOffset||220,g=n.picker.bottomOffset||16,b=n.picker.topBoundary||250,y=n.picker.leftOffset||75,w=n.slider.yOffset||15,x=n.slider.xOffset||0,M=n.slider.width,E=n.horizontalMode||"page",C=n.fixedContainer,k=(n.slider.callback||function(t){},n.picker.callback||function(t){},n.clicker.callback||function(t){},v.getWrapperElement());k.addEventListener("mouseup",l),document.body.addEventListener("mouseup",s),k.addEventListener("touchend",l),document.body.addEventListener("touchend",s),v.setOption("onKeyEvent",a);var L=document.createElement("div");L.className="inlet_clicker",L.style.visibility="hidden",L.style.position="absolute",m.appendChild(L);var p=document.createElement("input");p.className="checkbox",p.setAttribute("type","checkbox"),p.addEventListener("change",r),L.appendChild(p);var S=document.createElement("div");S.className="inlet_slider",S.style.visibility="hidden",M&&(S.style.width=M),C?S.style.position="fixed":S.style.position="absolute",S.style.top=0,m.appendChild(S);var d=document.createElement("input");d.className="range",d.setAttribute("type","range"),d.addEventListener("input",o),d.addEventListener("change",o);var R=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;R||d.addEventListener("mouseup",i),R||d.addEventListener("touchend",i),S.appendChild(d);var I,B=37,H=38,A=39,_=40,G=function(t,e){var n=v.getCursor();if(e){var r=c(n,e),o={line:n.line,ch:r.start},i={line:n.line,ch:r.end};v.picking=!0,v.replaceRange(t,o,i),setTimeout(function(){v.picking=!1},100)}};h=new thistle.Picker("#ffffff")}function e(t){var e=0;return t.length>2&&(e=parseFloat(t.slice(0,t.length-2))),e||(e=0),e}return t}();